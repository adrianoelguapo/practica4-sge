<!-- Declaración del archivo XML principal de vistas -->
<odoo>

  <data>

    <!-- Acción principal del módulo que abre el modelo lista_tareas.lista y muestra sus vistas. -->
    <record model = "ir.actions.act_window" id = "action_lista_tareas">

      <!-- Título visible de la ventana -->
      <field name = "name">Listado de tareas</field>

      <!-- Modelo al que se refiere la acción -->
      <field name = "res_model">lista_tareas.lista</field>

      <!-- Tipo de vistas que se mostrarán: list (tabla), form (formulario), kanban (kanban), calendar (calendario) -->
      <field name = "view_mode">list,form,kanban,calendar</field>

    </record>

    <!-- Menús del módulo que aparecerán en la barra superior -->

    <!-- Menú raíz que aparecerá en la barra superior -->
    <menuitem id = "lista_tareas_menu_root" name = "Listado de tareas" sequence = "10"/>

    <!-- Submenú dentro del menú raíz. Permite agrupar más opciones si lo necesitas en el futuro. -->
    <menuitem id = "lista_tareas_menu_1" name = "Gestión de tareas" parent = "lista_tareas_menu_root" sequence = "20"/>

    <!-- Opción final de menú que ejecuta la acción definida arriba. Abre la interfaz con lista y formulario de tareas. -->
    <menuitem id = "lista_tareas_menu_1_list" name = "Ver tareas" parent = "lista_tareas_menu_1" action = "action_lista_tareas" sequence = "30"/>

    <!-- Vista de lista -->
    <record id = "view_lista_tareas_list" model = "ir.ui.view">

      <!-- Nombre interno de la vista -->
      <field name = "name">lista.tareas.list</field>

      <!-- Modelo al que pertenece esta vista -->
      <field name = "model">lista_tareas.lista</field>

      <!-- Estructura XML de la vista -->
      <field name = "arch" type = "xml">

        <!-- Vista tipo list (reemplaza a <tree> en Odoo 17+) -->
        <list string = "Tareas" default_order = "prioridad desc">

          <!-- Campos que se muestran como columnas -->
          <field name = "tarea"/>         <!-- Nombre de la tarea -->
          <field name = "prioridad"/>     <!-- Nivel de prioridad -->
          <field name = "fecha"/>         <!-- Fecha de la tarea -->
          <field name = "urgente"/>       <!-- Urgente o no (calculado) -->
          <field name = "realizada"/>     <!-- Finalizada o no -->

        </list>

      </field>

    </record>

    <!-- Vista de formulario utilizada para crear y editar tareas -->
    <record id = "view_lista_tareas_form" model = "ir.ui.view">

      <!-- Nombre interno de la vista -->
      <field name = "name">lista.tareas.form</field>

      <!-- Modelo al que pertenece esta vista -->
      <field name = "model">lista_tareas.lista</field>

      <!-- Estructura XML de la vista -->
      <field name = "arch" type = "xml">

        <form string = "Tarea">

          <!-- El contenedor visual principal del formulario -->
          <sheet>

            <!-- Primer bloque de campos (agrupados) -->
            <group>

              <field name = "tarea"/>         <!-- Campo de nombre de tarea -->
              <field name = "fecha"/>         <!-- Campo de fecha -->
              <field name = "realizada"/>     <!-- Campo para marcar como realizada -->

            </group>

            <!-- Segundo bloque de campos (prioridad y urgencia) -->
            <group string = "Prioridad y urgencia">

              <field name = "prioridad"/>     <!-- Campo de prioridad editable -->

              <!-- Campo calculado: no editable. Ya no usamos attrs (Odoo 17+) -->
              <field name = "urgente" readonly = "1"/>

            </group>

          </sheet>

        </form>

      </field>

    </record>

    <!-- Vista de Kanban -->
    <record id = "view_lista_tareas_kanban" model = "ir.ui.view">

      <!-- Nombre interno de la vista -->
      <field name = "name">lista.tareas.kanban</field>

      <!-- Modelo al que pertenece esta vista -->
      <field name = "model">lista_tareas.lista</field>

      <!-- Estructura XML de la vista -->
      <field name = "arch" type = "xml">

        <!-- Contenedor de la vista kanban -->
        <kanban>

          <!-- Campos que se muestran -->
          <field name = "tarea"/>       <!-- Nombre de la tarea -->
          <field name = "prioridad"/>   <!-- Nivel de prioridad -->
          <field name = "fecha"/>       <!-- Fecha límite de la tarea -->

          <!-- Plantilla de la vista kanban -->
          <templates>

            <!-- Plantilla de la vista kanban -->
            <t t-name = "kanban-box">

              <!-- Contenedor global de la vista kanban -->
              <div class = "oe_kanban_global_click">

                <!-- Contenedor superior de la vista kanban -->
                <div class = "o_kanban_record_top">

                  <!-- Contenedor de la tarea -->
                  <div class = "o_kanban_record_headings">

                      <!-- Título de la tarea -->
                      <field name = "tarea"/>

                  </div>

                </div>

                <!-- Contenedor inferior de la vista kanban -->
                <div class = "o_kanban_record_bottom">

                  <!-- Contenedor izquierdo de la vista kanban -->
                  <div class = "oe_kanban_bottom_left">

                      <!-- Fecha límite de la tarea -->
                      <field name = "fecha"/>

                  </div>

                  <!-- Contenedor derecho de la vista kanban -->
                  <div class = "oe_kanban_bottom_right">

                      <!-- Nivel de prioridad de la tarea -->
                      <span class = "badge badge-secondary">

                        <!-- Nivel de prioridad de la tarea -->
                        <field name = "prioridad"/>

                      </span>

                  </div>

                </div>
1
              </div>

            </t>

          </templates>

        </kanban>

      </field>

    </record>

    <!-- Vista de Calendario -->
    <record id = "view_lista_tareas_calendar" model = "ir.ui.view">

      <!-- Nombre interno de la vista -->
      <field name = "name">lista.tareas.calendar</field>

      <!-- Modelo al que pertenece esta vista -->
      <field name = "model">lista_tareas.lista</field>

      <!-- Estructura XML de la vista -->
      <field name = "arch" type = "xml">

        <!-- Vista tipo calendario -->
        <calendar string = "Calendario de Tareas" date_start = "fecha" color = "prioridad" mode = "month">

          <!-- Campos que se muestran -->
          <field name = "tarea"/>       <!-- Nombre de la tarea -->
          <field name = "prioridad"/>   <!-- Nivel de prioridad -->

        </calendar>

      </field>

    </record>

    <!-- Vista de Búsqueda -->
    <record id = "view_lista_tareas_search" model = "ir.ui.view">

      <!-- Nombre interno de la vista -->
      <field name = "name">lista.tareas.search</field>

      <!-- Modelo al que pertenece esta vista -->
      <field name = "model">lista_tareas.lista</field>

      <!-- Estructura XML de la vista -->
      <field name = "arch" type = "xml">

        <!-- Vista tipo search -->
        <search string = "Buscar tareas">

          <!-- Campo de búsqueda libre -->
          <field name = "tarea"/>

          <!-- Filtros predefinidos -->
          <filter name = "filtro_urgente" string = "Urgente" domain = "[('urgente','=',True)]"/>
          <filter name = "filtro_realizada" string = "Realizadas" domain = "[('realizada','=',True)]"/>

        </search>

      </field>

    </record>

  </data>

</odoo>